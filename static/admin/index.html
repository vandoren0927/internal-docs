<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <title>Content Manager</title>
    <!-- 1. 在加载 CMS 脚本前，先告诉它不要自动初始化 -->
    <script>
      window.CMS_MANUAL_INIT = true;
    </script>
    <!-- 2. 引入 Decap CMS（支持 GitHub App 后端的版本） -->
    <script src="https://unpkg.com/decap-cms@^3.0.0/dist/decap-cms.js"></script>
  </head>
  <body>
    <h1>Loading CMS…</h1>
    <script>
      // 3. 计算 config.json 的 URL（假设和 index.html 同目录）
      const configUrl = `${window.location.origin}${window.location.pathname.replace(/\/+$/, '')}/config.json`;
      // 4. 拉取你的 config.json，然后手动 init()
      fetch(configUrl)
        .then(res => {
          if (!res.ok) throw new Error(`Failed to load ${configUrl}: ${res.status}`);
          return res.json();
        })
        .then(cfg => {
          CMS.init({ config: cfg });
        })
        .catch(err => {
          document.body.innerHTML = `<pre style="color:red;">${err.message}</pre>`;
          console.error(err);
        });
    </script>
  </body>
</html>
