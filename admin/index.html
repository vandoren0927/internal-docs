<!doctype html>
<html lang="zh-TW">
<head>
  <meta charset="utf-8" />
  <title>Internal Docs CMS</title>
  <script>window.CMS_MANUAL_INIT=true;</script>
  <script src="https://unpkg.com/decap-cms@^3.0.0/dist/decap-cms.js"></script>
</head>
<body>
  <h1>Loading CMS…</h1>
  <script>
    (async function() {
      // 根据 URL 动态拼 ./config.json
      const base = window.location.pathname.replace(/\/+$/, '');
      const cfgUrl = `${base}/config.json`;
      const res = await fetch(cfgUrl);
      if (!res.ok) throw new Error(`Cannot load ${cfgUrl}: ${res.status}`);
      const cfg = await res.json();
      // 用 initCMS 而非 CMS.init
      const { initCMS } = window;
      initCMS({ config: cfg, load_config_file: false });
    })().catch(e => {
      document.body.innerHTML = `<pre style="color:red;">${e.message}</pre>`;
      console.error(e);
    });
  </script>
</body>
</html>
